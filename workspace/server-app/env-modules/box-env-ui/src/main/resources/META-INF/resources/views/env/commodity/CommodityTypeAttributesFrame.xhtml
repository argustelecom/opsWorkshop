<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
				xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
				xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
				xmlns:o="http://omnifaces.org/ui" xmlns:sysinf="http://argustelecom.ru/system-inf"
				xmlns:pm="http://primefaces.org/modena" xmlns:f="http://java.sun.com/jsf/core">

	<p:outputPanel id="commodity_type_attribute_panel">

		<f:event listener="#{commodityTypeAttrFm.preRender(nodeDto, callbackAfterGroupChanged)}" type="preRenderComponent"/>
		
		<h:form id="commodity_type_attribute_form">
			<div class="columns">
				<div class="column m-pad-0">
					<p:panelGrid columns="1" layout="grid" styleClass="ui-panelgrid-blank m-tex-al-center column-id">
						<i class="#{commodityTypeAttrFm.icon} fs60" />
						<h:outputText value="#{overallBundle['box.overall.id']} #{commodityTypeAttrFm.attrDto.id}" />
					</p:panelGrid>
				</div>

				<div class="column width-100-percents">
					<div class="columns">
						<div class="column m-container50 m-responsive100">
							<sysinf:editableSection disabled="#{!p:ifGranted('System_CommodityTypeEdit') or commodityTypeAttrFm.attrDto eq null}"
							saveLabel="#{overallBundle['box.overall.save']}"
										cancelLabel="#{overallBundle['box.overall.cancel']}">

								<p:ajax event="save" listener="#{commodityTypeAttrFm.onNameChange()}" update="#{update}"/>

								<dl class="name-value width-100">
									<dt>
										<p:outputLabel for="name" value="#{overallBundle['box.overall.name']}" />
									</dt>
									<dd>
										<p:inputText id="name" value="#{commodityTypeAttrFm.attrDto.name}" required="true">
											<f:validateLength maximum="512"/>
										</p:inputText>
									</dd>
								</dl>
							</sysinf:editableSection>

							<sysinf:editableSection disabled="#{!p:ifGranted('System_CommodityTypeEdit') or commodityTypeAttrFm.attrDto eq null}">

								<p:ajax event="save" listener="#{commodityTypeAttrFm.onGroupChange()}" update="#{update}"/>

								<dl class="name-value width-100">
									<dt>
										<p:outputLabel for="group" value="#{overallBundle['box.overall.group']}" />
									</dt>
									<dd>
										<p:selectOneMenu value="#{commodityTypeAttrFm.attrDto.parent}">
											<f:selectItem itemValue="" itemDisabled="#{not commodityTypeAttrFm.attrDto.isGroup()}"/>
											<f:selectItems value="#{commodityTypeAttrFm.groups}" var="group" itemValue="#{group}"
														   itemLabel="#{group.objectName}"/>
										</p:selectOneMenu>
										<p:inputText id="group" value="#{commodityTypeAttrFm.attrDto.parent.name}" disabled="true"/>
									</dd>
								</dl>
							</sysinf:editableSection>

							<dl class="name-value width-110">
								<dt>
									<p:outputLabel for="main_type" value="#{typeBundle['box.type.kind']}" />
								</dt>
								<dd>
									<h:outputText id="main_type" value="#{commodityTypeAttrFm.attrDto.type.name}"/>
								</dd>
							</dl>
						</div>

						<div class="m-container50 m-responsive100">
							<div class=" m-pos-relative">
								<div class="hover-overlay-block">
									<ui:fragment rendered="#{not commodityTypeAttrFm.attrDto.group}">
										<sysinf:editableSection disabled="#{!p:ifGranted('System_CommodityTypeEdit') or commodityTypeAttrFm.attrDto eq null}"
										saveLabel="#{overallBundle['box.overall.save']}"
												cancelLabel="#{overallBundle['box.overall.cancel']}">

											<p:ajax event="save" listener="#{commodityTypeAttrFm.onDescriptionChange()}"/>

											<dl class="name-value width-100">
												<dt>
													<p:outputLabel for="type_desc" value="#{overallBundle['box.overall.desc']}" />
												</dt>
												<dd class="auto-height">
													<p:inputTextarea id="type_desc" value="#{commodityTypeAttrFm.attrDto.description}"
																	 maxlength="256" counterTemplate="#{overallBundle['box.overall.chars_left']}"  counter="type_desc_counter" />
					
													<h:outputText id="type_desc_counter" styleClass="fs12"/>
												</dd>
											</dl>

										</sysinf:editableSection>
									</ui:fragment>

									<ui:fragment rendered="#{commodityTypeAttrFm.attrDto.group}">
										<sysinf:editableSection disabled="#{!p:ifGranted('System_CommodityTypeEdit') or commodityTypeAttrFm.attrDto eq null}">

										<p:ajax event="save" listener="#{commodityTypeAttrFm.onKeywordChange()}"/>

											<dl class="name-value width-110">
												<dt>
													<p:outputLabel for="keyword" value="#{overallBundle['box.overall.keyword']}"/>
												</dt>
												<dd>
													<p:inputText id="keyword" value="#{commodityTypeAttrFm.attrDto.keyword}"/>
												</dd>
											</dl>
										</sysinf:editableSection>
									</ui:fragment>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</h:form>
	</p:outputPanel>
</ui:composition>