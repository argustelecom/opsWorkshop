<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:sysinf="http://argustelecom.ru/system-inf" xmlns:pm="http://primefaces.org/modena"
	xmlns:f="http://java.sun.com/jsf/core">

	<f:loadBundle var="activityBundle" basename="ActivityBundle"/>
	<p:outputPanel>
		<f:event listener="#{activityFrm.preRender(contextObject, frameHeight)}" type="preRenderComponent" />

		<h:form id="activity_form" rendered="#{activityFrm.rendered}">
			<o:importConstants type="ru.argustelecom.box.env.activity.ActivityFrameModel.ActivityType" var="activityType"/>

			<p:tabMenu activeIndex="#{activityFrm.currentActivity.ordinal()}" rendered="#{activityFrm.rendered}">
				<p:menuitem action="#{activityFrm.currentActivity(activityType.COMMENTS)}" update="activity_form"
					rendered="#{activityFrm.commentsSupported}">
					<i class="fa fa-comments fs20 m-mar-right10 m-fleft"></i>
					<span class="fs18 m-fleft">#{activityBundle['box.activity.comment.plural']}</span>
				</p:menuitem>
				<p:menuitem action="#{activityFrm.currentActivity(activityType.ATTACHMENTS)}" update="activity_form"
					rendered="#{activityFrm.attachmentsSupported}">
					<i class="icon-attach_file fs20 m-mar-right10 m-fleft"></i>
					<span class="fs18 m-fleft">#{activityBundle['box.activity.attachment.plural']}</span>
				</p:menuitem>
				<p:menuitem action="#{activityFrm.currentActivity(activityType.HISTORY)}" update="activity_form"
					rendered="#{activityFrm.historySupported}">
					<i class="icon-repeat2 fs20 m-mar-right10 m-fleft"></i>
					<span class="fs18 m-fleft">#{activityBundle['box.activity.history']}</span>
				</p:menuitem>
			</p:tabMenu>

			<div class="m-empty-box10" />

			<ui:fragment rendered="#{activityFrm.currentActivity eq activityType.COMMENTS and activityFrm.commentsSupported}">
				<ui:include src="/views/env/activity/comment/CommentFrame.xhtml">
					<ui:param name="commentsContext" value="#{activityFrm.commentsContext}" />
					<ui:param name="commentsPageSize" value="10" />
					<ui:param name="commentsHeight" value="#{activityFrm.commentsHeight}" />
				</ui:include>
			</ui:fragment>

			<ui:fragment rendered="#{activityFrm.currentActivity eq activityType.ATTACHMENTS and activityFrm.attachmentsSupported}">
				<ui:include src="/views/env/activity/attachment/AttachmentFrame.xhtml">
					<ui:param name="attachmentsContext" value="#{activityFrm.attachmentsContext}" />
					<ui:param name="attachmentsSizeLimit" value="31457280" />
					<ui:param name="attachmentsAppendable" value="true" />
					<ui:param name="attachmentsScrollable" value="true" />
					<ui:param name="attachmentsScrollHeight" value="#{activityFrm.attachmentsHeight}" />
				</ui:include>
			</ui:fragment>

			<ui:fragment rendered="#{activityFrm.currentActivity eq activityType.HISTORY and activityFrm.historySupported}">
				<ui:include src="/views/env/lifecycle2/LifecycleHistoryFrame.xhtml">
					<ui:param name="bundle" value="#{bundle}"/>
					<ui:param name="dashboardHeader" value="false"/>
					<ui:param name="scrollHeight" value="500"/>
					<ui:param name="historyContext" value="#{activityFrm.historyContext}" />
				</ui:include>
			</ui:fragment>
		</h:form>
	</p:outputPanel>

</ui:composition>