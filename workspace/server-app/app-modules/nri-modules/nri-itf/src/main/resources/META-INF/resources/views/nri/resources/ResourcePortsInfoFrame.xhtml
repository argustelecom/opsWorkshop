<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:p="http://primefaces.org/ui"
				xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:o="http://omnifaces.org/ui"
>


	<f:event listener="#{resourcePortsInfoFM.preRender(resourceInstance)}"
			 type="preRenderComponent"/>
	<style type="text/css">
		.ui-datatable.borderless thead {
			display: none;
		}
	</style>
	<f:loadBundle basename="PortsBundle" var="portsBundle"/>
	<div class="m-container100">
		<div class="m-container-indent">
			<ui:fragment id="party_type_tree_form">
				<p:outputPanel styleClass="m-card m-shadow-effect m-hei-auto-on-mobile simple-fb">


					<div class="ui-dashboard-header">
						<i class="fa fa-server"/>
						<h:outputText styleClass="card-header"
									  value="#{portsBundle['box.nri.ports.list_header']}"/>
						<p:outputPanel id="ports_buttons_panel" styleClass="m-fright">
							<p:commandLink id="create_port_button" styleClass="m-mar-left10"
										   update="possible_ports_type"

										   title="#{overallBundle['box.overall.create']}">
								<i class="fa fa-edit icon-btn"/>
							</p:commandLink>
							<p:commandLink id="delete_port_button" styleClass="m-mar-left10"
										   update="ports_info_form"
										   action="#{resourcePortsInfoFM.deletePort()}"
										   title="#{overallBundle['box.overall.delete']}"
										   disabled="#{!resourcePortsInfoFM.canDelete()}"
							>
								<i class="fa fa-trash icon-btn"/>

								<p:confirm header="#{portsBundle['box.nri.ports.remove_header']}"
										   message="#{portsBundle['box.nri.ports.remove_message']}"/>
							</p:commandLink>

							<p:overlayPanel id="port_creation_panel" widgetVar="portCreationPanelVar"
											for="create_port_button"
											styleClass="select-one-item-overlay-panel" update="possible_ports_type">
								<p:selectOneListbox id="possible_ports_type" value="#{addPortDM.selectedType}"
													var="type" rendered="#{resourceVM.selectedResource ne null}">

									<p:ajax process="@this" update="port_creation"
											listener="#{addPortDM.createPort()}"/>

									<f:selectItems
											value="#{resourceVM.selectedResource.specification.supportedPortTypes}"
											var="pc"
											itemValue="#{pc}" itemLabel="#{pc}"/>
									<p:column>
										<h:outputText value="#{type.name}"/>
									</p:column>
								</p:selectOneListbox>
							</p:overlayPanel>
						</p:outputPanel>
					</div>

					<p:outputPanel id="port_info" rendered="#{resourcePortsInfoFM.portList ne null}">
						<o:importConstants type="ru.argustelecom.box.nri.ports.model.PortTechnicalCondition" var="techCond"/>
						<o:importConstants type="ru.argustelecom.box.nri.ports.model.PortPurpose" var="purpose"/>
						<div class="columns">
							<div class="column width-45-percents m-pad-left20">
								<p:scrollPanel style="width:95%;border:none;" mode="native">

									<p:dataTable id="port_table" value="#{resourcePortsInfoFM.portList}"
												 var="port"
												 style="min-height: 300px;"
												 styleClass="borderless"
												 selection="#{resourcePortsInfoFM.selectedPort}"
												 rowExpandMode="single"
												 rowKey="#{port.id}" scrollable="true" scrollHeight="90%"
												 selectionMode="single" >
										<p:ajax event="rowSelect"
												update="ports_info_form-delete_port_button ports_info_form"/>
										<p:ajax event="rowUnselect"
												update="ports_info_form-delete_port_button"/>
										<p:ajax event="toggleSelect" update="ports_info_form-delete_port_button"/>
										<p:column styleClass="width-20-percents">
											<h:outputText id="name_out" value="#{port.portNumber}"/>
										</p:column>
										<p:column styleClass="width-25-percents">
											<i class="#{port.technicalCondition eq techCond.IN_ORDER ? 'icon-check m-green' : 'icon-cross m-red'} fs16"
											   title="#{portsBundle['box.nri.ports.technical_сondition']} #{port.technicalCondition.name}"/>
											<i class="#{port.portPurpose eq purpose.SUBSCRIBER? 'fa fa-user' : 'fa fa-android'} fs16"
											   title="#{portsBundle['box.nri.ports.purpose']} #{port.portPurpose.name}"/>
										</p:column>
										<p:column styleClass="width-55-percents">
											<h:outputText id="spec_out" value=" #{port.type.name}"/>
											<!--<i class="#{port.portPurpose eq purpose.SUBSCRIBER? 'fa fa-users' : 'fa fa-android'} fs16"-->
											   <!--title="#{portsBundle['box.nri.ports.purpose']} #{port.portPurpose.name}"/>-->
										</p:column>
									</p:dataTable>
								</p:scrollPanel>
							</div>

							<div class="column width-55-percents m-pad-left20">
								<p:panel id="port_detail_info" style="height: 300px"
											   rendered="#{resourcePortsInfoFM.selectedPort ne null}">
									<ui:include src="./ports/PortDetailInfoFrame.xhtml">
										<ui:param name="port" value="#{resourcePortsInfoFM.selectedPort}"/>
										<ui:param name="update" value="ports_info_form-ports_info_panel"/>
									</ui:include>
								</p:panel>
							</div>
						</div>
					</p:outputPanel>
				</p:outputPanel>
			</ui:fragment>
		</div>
	</div>
</ui:composition>