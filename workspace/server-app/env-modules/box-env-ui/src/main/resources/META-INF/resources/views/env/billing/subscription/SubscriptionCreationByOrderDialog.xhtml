<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
				xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
				xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
				xmlns:o="http://omnifaces.org/ui" xmlns:sysinf="http://argustelecom.ru/system-inf"
				xmlns:pm="http://primefaces.org/modena" xmlns:f="http://java.sun.com/jsf/core"
				xmlns:boxenv="http://argustelecom.ru/box/env">

	<f:loadBundle var="subscriptionBundle" basename="SubscriptionBundle"/>
	<h:form id="subscription_creation_by_order_form">
		<p:dialog id="subscription_creation_dlg" header="#{subscriptionBundle['box.subscription.create_dialog']}"
				  width="600" styleClass="icon-creation sub-contract"
				  widgetVar="subscriptionCreationByOrderDlgVar" resizable="false" modal="true" closable="false" dynamic="true">

			<dl class="name-value width-200">

				<o:importConstants type="ru.argustelecom.box.env.billing.subscription.SubjectCauseType" var="scType"/>

				<dt>
					<p:outputLabel value="#{subscriptionBundle['box.subscription.cause']}:"/>
				</dt>
				<dd>
					<boxenv:selectSubscriptionSubjectCause value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.subjectCause}"
													   customer="#{subscriptionCreationByOrderDm.customer}"
													   type="#{scType.ORDER}"
														   label="#{subscriptionBundle['box.subscription.cause']}"/>
				</dd>
				<dt>
					<p:outputLabel for="pricelist" value="#{subscriptionBundle['box.subscription.pricelist']}:"/>
				</dt>
				<dd>
					<p:selectOneMenu id="pricelist" value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.pricelist}">

						<f:selectItem itemValue=""/>
						<f:selectItems value="#{subscriptionCreationByOrderDm.pricelists}" var="pricelist"
									   itemLabel="#{pricelist.name}" itemValue="#{pricelist}"/>
						<p:ajax process="@this" listener="#{subscriptionCreationByOrderDm.onPricelistSelected()}" update="subscription_creation_by_order_form-product"/>
					</p:selectOneMenu>
				</dd>
				<dt>
					<p:outputLabel for="product" value="#{subscriptionBundle['box.subscription.product']}:"/>
				</dt>
				<dd>
					<p:selectOneMenu id="product" value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.productOffering}">

						<p:ajax process="@this" update="product_info"/>

						<f:selectItem itemValue=""/>
						<f:selectItems value="#{subscriptionCreationByOrderDm.productOfferings}" var="product"
									   itemLabel="#{product.productName}" itemValue="#{product}"/>
					</p:selectOneMenu>
				</dd>
			</dl>
			<p:outputPanel id="product_info">
				<dl class="name-value width-200 nv-margin-bot10">
					<dt>
						<p:outputLabel for="provistion_terms"
									   value="#{subscriptionBundle['box.subscription.provision.term']}:"/>
					</dt>
					<dd>
						<h:outputText id="provistion_terms" value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.productOffering.provisionTermsName}"/>
					</dd>
					<dt>
						<p:outputLabel for="provistion_terms_desc" value="#{overallBundle['box.overall.desc']}:"/>
					</dt>
					<dd>
						<h:outputText id="provistion_terms_desc" value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.productOffering.provisionTermsDescription}"/>
					</dd>
					<dt>
						<p:outputLabel for="cost" value="#{subscriptionBundle['box.subscription.amount']}:"/>
					</dt>
					<dd>
						<boxenv:money id="cost" value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.productOffering.price}" size="fs14" unicolour="true"
										rendered="#{subscriptionCreationByOrderDm.subscriptionCreationDto.productOffering != null}"/>
					</dd>
					<dt>
						<p:outputLabel for="validFrom" value="#{overallBundle['box.overall.valid_from']}:"/>
					</dt>
					<dd>
						<p:calendar id="validFrom" styleClass="width-40-percents" pattern="#{dateUtils.DATETIME_DEFAULT_PATTERN}"
									value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.validFrom}"
									locale="#{languageBean.locale.language}"/>
						<p:outputLabel for="validTo" styleClass="m-tex-al-right width-17-percents m-pad-right10"
									   value="#{overallBundle['box.overall.to']}:"/>
						<p:calendar id="validTo" styleClass="m-tex-al-right width-40-percents" pattern="#{dateUtils.DATETIME_DEFAULT_PATTERN}"
									value="#{subscriptionCreationByOrderDm.subscriptionCreationDto.validTo}"
									locale="#{languageBean.locale.language}"/>
					</dd>
				</dl>
			</p:outputPanel>

			<dl class="name-value width-200 nv-margin-bot10">
				<dt>
					<p:outputLabel for="amountpay" value="Сумма обещанного платежа:"/>
				</dt>
				<dd>
					<p:inputText id="amountpay" value="123" disabled="true"/>
				</dd>
			</dl>

			<div class="message message-info message-icon message-icon-info m-mar-top20">
				<p>Внимание! При подтверждении подписка будет автоматически переведена в статус "Действует". С этого момента начнется тарификация продукта!</p>
			</div>

			<div class="dialog-footer-buttons">
				<p:commandButton id="cancel_button" value="#{overallBundle['box.overall.cancel']}"
								 styleClass="m-blue-text-button" update="subscription_creation_dlg"
								 process="@this" action="#{subscriptionCreationByOrderDm.clean()}"
								 onclick="PF('subscriptionCreationByOrderDlgVar').hide()"/>
				<p:commandButton id="create_button" value="#{overallBundle['box.overall.create']}"
								 oncomplete="if (args &amp;&amp; !args.validationFailed) {PF('subscriptionCreationByOrderDlgVar').hide()}"
								 action="#{subscriptionCreationByOrderDm.create()}" process="subscription_creation_dlg" update="#{update}"/>
			</div>
		</p:dialog>
	</h:form>

</ui:composition>