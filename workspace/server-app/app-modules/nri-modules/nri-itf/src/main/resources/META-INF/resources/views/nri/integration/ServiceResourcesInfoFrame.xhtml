<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui"
				xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:c="http://java.sun.com/jsp/jstl/core">

	<f:event listener="#{serviceResourceInfoFrameModel.preRender(service)}"
			 type="preRenderComponent"/>

	<f:loadBundle basename="NriIntegrationBundle" var="integrationBundle"/>

	<o:importConstants type="ru.argustelecom.box.nri.schema.requirements.model.RequirementType"
					   var="bookingRequirementType"/>

	<h:form id="service_resource_list_form" rendered="#{serviceResourceInfoFrameModel.shouldBeRendered()}">
		<div class="m-container100">
			<div class="m-container-indent">
				<div class="m-card m-shadow-effect simple-fb">
					<div class="ui-dashboard-header">
						<i class="fa fa-list-ol"/>
						<h:outputText styleClass="card-header"
									  value="#{integrationBundle['box.nri.integration.frame.header']}"/>
					</div>

					<ui:fragment rendered="#{serviceResourceInfoFrameModel.shouldRenderSchemaSelection()}">
						<dl class="name-value width-150">
							<dt>
								<p:outputLabel for="schema_selector"
											   value="#{integrationBundle['box.nri.integration.frame.schema_selector']}:"/>
							</dt>
							<dd>
								<p:selectOneMenu id="schema_selector"
										value="#{serviceResourceInfoFrameModel.selectedSchema}" style="width: 100%;">
									<p:ajax update="@form" listener="#{serviceResourceInfoFrameModel.initializeRequirementsModel}"/>
									<f:selectItem itemLabel="" itemValue="" noSelectionOption="true"/>
									<f:selectItems value="#{serviceResourceInfoFrameModel.availableSchemas}" var="itm"
												   itemLabel="#{itm.name}"/>
								</p:selectOneMenu>
							</dd>
						</dl>
					</ui:fragment>

					<ui:fragment rendered="#{serviceResourceInfoFrameModel.shouldRenderLoadings()}">
						<p:dataTable var="res" value="#{serviceResourceInfoFrameModel.loadings}" rows="10"
									 paginator="#{fn:length(serviceResourceInfoFrameModel.loadings) > 10}" paginatorPosition="bottom"
									 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}">

							<p:column headerText="#{integrationBundle['box.nri.integration.frame.id_word']}">
								<h:outputLink value="#{request.contextPath}/#{res.buildResourceUrl()}">
									<h:outputText value="#{res.id}"/>
								</h:outputLink>
							</p:column>

							<p:column headerText="#{integrationBundle['box.nri.integration.frame.name_word']}">
								<h:outputText value="#{res.resourceName}" />
							</p:column>

							<p:column headerText="#{integrationBundle['box.nri.integration.frame.type_word']}">
								<h:outputText value="#{res.type.name}" />
							</p:column>
						</p:dataTable>
					</ui:fragment>

					<ui:fragment rendered="#{serviceResourceInfoFrameModel.shouldRenderBookings()}">
						<p:scrollPanel style="width:95%;height:300px;border:none;" mode="native">
							<p:accordionPanel value="#{serviceResourceInfoFrameModel.bookings}" var="booking"
											  id="booking_information_accordion"
											  multiple="false" dynamic="true" cache="true">
								<p:tab>
									<f:facet name="title">
										<ui:fragment rendered="#{booking.isBooked()}">
										<i class="fa fa-check" style="color: limegreen;"/>
										</ui:fragment>
										<ui:fragment rendered="#{not booking.isBooked()}">
											<i class="fa fa-exclamation" style="color: firebrick;"/>
										</ui:fragment>
										#{booking.name}
									</f:facet>
									<ui:fragment rendered="#{booking.isBooked()}">
										<ui:include src="frames/BookedResourceFrame.xhtml">
											<ui:param name="booking" value="#{booking}"/>
											<ui:param name="update" value=":service_resource_list_form:booking_information_accordion:tab#{booking_information_accordion.activeIndex}"/>
										</ui:include>
									</ui:fragment>
									<ui:fragment rendered="#{!booking.isBooked()
												and booking.requirement.type eq bookingRequirementType.PHONE_NUMBER_BOOKING_REQUIREMENT}">
										<ui:include src="frames/BookPhoneNumberFrame.xhtml">
											<ui:param name="booking" value="#{booking}"/>
											<ui:param name="service" value="#{service}"/>
										</ui:include>
									</ui:fragment>
									<ui:fragment rendered="#{ not booking.isBooked() and booking.requirement.type eq bookingRequirementType.IP_ADDRESS_BOOKING_REQUIREMENT}">
											<ui:include src="frames/BookingIPResourceFrame.xhtml">
												<ui:param name="" value="#{serviceResourceInfoFrameModel.createNewBooking}"/>
												<ui:param name="service" value="#{service}"/>
												<ui:param name="booking" value="#{booking}"/>
												<ui:param name="update" value="-service_resource_list_form"/>
											</ui:include>
									</ui:fragment>
								</p:tab>
							</p:accordionPanel>
						</p:scrollPanel>
					</ui:fragment>
				</div>
			</div>
		</div>
	</h:form>

</ui:composition>