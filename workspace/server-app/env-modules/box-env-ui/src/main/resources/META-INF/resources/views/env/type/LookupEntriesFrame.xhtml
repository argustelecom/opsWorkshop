<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:sysinf="http://argustelecom.ru/system-inf" xmlns:pm="http://primefaces.org/modena">

	<f:loadBundle basename="LookupBundle" var="lookupBundle" />

	<h:form id="entries_form">
		<f:attribute name="updateEvent" value="#{currentLookupCategory.changedEvent}"/>
		<f:event listener="#{lookupEntriesFrameModel.preRender()}" type="preRenderComponent"/>
	
		<f:loadBundle basename="OverallBundle" var="overallBundle" />
		<f:loadBundle basename="LookupBundle" var="lookupBundle" />
	
		<div class="ui-dashboard-header">
			<i class="fa fa-tasks" />
			<h:outputText value="#{lookupBundle['box.lookup.entry.plural']}" styleClass="card-header"/>

			<p:outputPanel id="managed_buttons" styleClass="m-fright">
				<p:selectBooleanCheckbox id="show_all_lookup_entries"
							value="#{lookupEntriesFrameModel.showAllEntries}" label="#{overallBundle['box.overall.show.all']}">
					<p:ajax update="entries_form" />
				</p:selectBooleanCheckbox>
				<p:outputLabel for="show_all_lookup_entries" styleClass="m-mar-right10"
							   value="#{lookupBundle['box.lookup.entry.deactivated.show']}" />
				
				<p:commandLink styleClass="m-mar-left10" process="@this"
								onclick="PF('lookupEntryCreationDlgVar').show()"
							   title="#{overallBundle['box.overall.create']}"
								disabled="#{!p:ifGranted('System_LookupDirectoryEdit') or currentLookupCategory.value eq null}" >
								<i class="fa fa-edit icon-btn"/>
				</p:commandLink>
				<p:commandLink styleClass="m-mar-left10" action="#{lookupEntriesFrameModel.toggleActive()}"
								update="entries_form" disabled="#{!p:ifGranted('System_LookupDirectoryEdit') or empty lookupEntriesFrameModel.selectedTypes}"
								title="#{lookupBundle['box.lookup.entry.negate']}" >
								<i class="icon-sync_problem icon-btn"/>
				</p:commandLink>
			</p:outputPanel>
		</div>

		<p:dataTable id="entries" value="#{lookupEntriesFrameModel.types}" var="entry"
			selection="#{lookupEntriesFrameModel.selectedTypes}" rowKey="#{entry.id}"
			styleClass="m-ov-auto" editable="true" emptyMessage="#{overallBundle['box.overall.empty']}"
			rowStyleClass="#{entry.active ? null : 'inactive-entry'}">

			<p:ajax event="rowSelectCheckbox" update="entries_form-managed_buttons" />
			<p:ajax event="rowUnselectCheckbox" update="entries_form-managed_buttons" />
			<p:ajax event="rowSelect" update="entries_form-managed_buttons" />
			<p:ajax event="rowUnselect" update="entries_form-managed_buttons" />
			<p:ajax event="toggleSelect" update="entries_form-managed_buttons" />

			<p:column selectionMode="multiple" styleClass="width-16 m-tex-al-center" />

			<p:column headerText="#{overallBundle['box.overall.name']}">
				<p:cellEditor>
               		<f:facet name="output"><h:outputText value="#{entry.objectName}" /></f:facet>
               		<f:facet name="input">
               			<p:inputText value="#{entry.objectName}" required="true" label="#{overallBundle['box.overall.name']}"/>
               		</f:facet>
           		</p:cellEditor>
			</p:column>

			<p:column headerText="#{overallBundle['box.overall.desc']}">
				<p:cellEditor>
               		<f:facet name="output"><h:outputText value="#{entry.description}" /></f:facet>
               		<f:facet name="input">
               			<p:inputText value="#{entry.description}" />
               		</f:facet>
           		</p:cellEditor>
			</p:column>
			
			<p:column styleClass="width-32" rendered="#{p:ifGranted('System_LookupDirectoryEdit')}">
				<p:rowEditor editTitle="#{overallBundle['box.overall.edit']}"/>
			</p:column>
		</p:dataTable>

		<script>
			$( document ).ready(function() {
				Argus.System.AutoHeight.compute('entries_form', 50);
				Argus.System.AutoHeight.compute('entries_form-entries', 50);
			});
		</script>
	</h:form>
</ui:composition>