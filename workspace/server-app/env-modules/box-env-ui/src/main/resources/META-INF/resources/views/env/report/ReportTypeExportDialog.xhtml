<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
                xmlns:sysinf="http://argustelecom.ru/system-inf" xmlns:pm="http://primefaces.org/modena"
                xmlns:f="http://java.sun.com/jsf/core" xmlns:boxenv="http://argustelecom.ru/box/env">

    <f:loadBundle var="reportBundle" basename="ReportBundle"/>
    <h:form id="report_type_export_form">

        <p:dialog id="report_type_export_dlg" header="#{reportBundle['box.report.create']} #{reportTypeExportDm.reportType.name}" width="500"
                  widgetVar="reportTypeExportDlgVar" styleClass="icon-creation"
                  resizable="false" modal="true" closable="false" dynamic="true">

            <ui:include src="/views/env/type/GroupTypePropertyValueFrame.xhtml">
                <ui:param name="styleClass" value="property-value-30"/>
                <ui:param name="instance" value="#{reportTypeExportDm.reportParams}"/>
            </ui:include>

            <h3 class="h3-header bottom-border">
                <h:outputText value="#{reportBundle['box.report.template.settings']}"/>
            </h3>

            <dl class="name-value width-150">
                <dt>
                    <p:outputLabel for="template" value="#{reportBundle['box.report.template']}:"/>
                </dt>
                <dd>
                    <p:selectOneMenu id="template" value="#{reportTypeExportDm.selectedTemplate}" required="true">
                        <p:ajax update="report_format"/>
                        <f:selectItems value="#{reportTypeExportDm.templates}" var="template"
									   itemLabel="#{template.name}" itemValue="#{template}"/>
                    </p:selectOneMenu>
                </dd>
                <dt>
                    <p:outputLabel for="report_format" value="#{reportBundle['box.report.format']}:"/>
                </dt>
                <dd>
                    <p:selectOneMenu id="report_format" value="#{reportTypeExportDm.selectedOutputFormat}" required="true">
                        <f:selectItems value="#{reportTypeExportDm.selectedTemplate.availableOutputFormats}"
									   var="format" itemLabel="#{format.name().toLowerCase()}" itemValue="#{format}"/>
                    </p:selectOneMenu>
                </dd>
            </dl>

            <div class="dialog-footer-buttons">
                <p:commandButton id="cancel_button" styleClass="m-blue-text-button"
                                 value="#{overallBundle['box.overall.cancel']}"
                                 update="report_type_export_dlg" process="@this"
                                 onclick="PF('reportTypeExportDlgVar').hide()" resetValues="true"/>
                <p:commandButton id="create_button" value="#{overallBundle['box.overall.create']}"
                                 update="#{update}" ajax="false" resetValues="true"
                                 oncomplete="if (args &amp;&amp; !args.validationFailed) {PF('reportTypeExportDlgVar').hide()}">
                    <p:fileDownload value="#{reportTypeExportDm.onExport()}"/>
                </p:commandButton>
            </div>
        </p:dialog>
    </h:form>
</ui:composition>