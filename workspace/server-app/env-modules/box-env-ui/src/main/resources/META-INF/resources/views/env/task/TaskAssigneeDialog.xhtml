<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:p="http://primefaces.org/ui">

	<f:loadBundle var="taskBundle" basename="TaskBundle"/>
	<p:dialog id="assignee_selection_dlg" header="#{taskBundle['box.task.assign_dialog']}" width="570"
              widgetVar="assigneeSelectionDlgVar" resizable="false" styleClass="icon-creation"
              modal="true" closable="false" dynamic="true">

		<h:form id="assignee_selection_form">
			<dl class="name-value width-200">
				<dt>
					<p:outputLabel for="task_assignee" value="#{taskBundle['box.task.assignee']}:"/>
				</dt>

				<dd>
					<p:selectOneMenu id="task_assignee" value="#{taskAssigneeDialogModel.assignee}"
									 converter="omnifaces.SelectItemsConverter"
									 process="@this"
									 var="assignee">

						<p:ajax process="@this" update="assignee_selection_form"/>

						<f:selectItem itemValue="#{taskAssigneeDialogModel.currentEmployee}"
									  itemLabel="#{taskAssigneeDialogModel.currentEmployee.name}"/>
						<f:selectItems value="#{taskAssigneeDialogModel.assignees}"/>

						<p:column>
							<h:outputText
									styleClass="#{assignee['class'].simpleName eq 'RoleDto' ? 'm-font-bold' : ''}"
									value="#{assignee.name}"/>
						</p:column>
					</p:selectOneMenu>
				</dd>
			</dl>
			<div class="message message-icon message-icon-info">
				<p>#{taskBundle['box.task.assign.count']} #{taskAssigneeDialogModel.selectedTasks.size()}.</p>
				<p>#{taskBundle['box.task.assign.requirements']} #{taskAssigneeDialogModel.formatRoles()}</p>
			</div>

			<div class="dialog-footer-buttons">
				<p:commandButton id="cancel_button" value="#{overallBundle['box.overall.cancel']}"
								 styleClass="m-blue-text-button"
								 update="assignee_selection_dlg"
								 process="@this"
								 onclick="PF('assigneeSelectionDlgVar').hide()"/>
				<p:commandButton id="assign_button" value="#{taskBundle['box.task.assign']}"
								 oncomplete="PF('assigneeSelectionDlgVar').hide()"
								 action="#{taskAssigneeDialogModel.onAssign()}"
								 process="assignee_selection_dlg" update="#{update}">
				</p:commandButton>
			</div>
		</h:form>
	</p:dialog>

</ui:composition>