<ui:component xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:sys="http://argustelecom.ru/system" xmlns:sysinf="http://argustelecom.ru/system-inf">

	<f:loadBundle var="documentTypeTemplateBundle" basename="DocumentTypeTemplateBundle"/>
	<h:form id="doctype_templates_form">
		<f:event listener="#{reportTemplatesFm.preRender(templateHolder)}" type="preRenderComponent" />

		<div class="ui-dashboard-header">
			<i class="fa fa-file-word-o"></i>
			<h:outputText value="#{documentTypeTemplateBundle['box.doc.type.template.plural']}" styleClass="card-header"/>

			<p:outputPanel id="property_managed_buttons" styleClass="m-fright">

				<p:commandLink styleClass="m-mar-left10" oncomplete="PF('doctypeTemplatesDlgVar').show()"
							   title="#{overallBundle['box.overall.add']}" disabled="#{readonly or reportTemplatesFm.holderDto eq null}"
								update="doctype_templates_edit_form">
								<i class="fa fa-edit icon-btn"/>
								<f:setPropertyActionListener value="#{reportTemplatesFm.holderDto}" target="#{reportTemplatesDm.holderDto}" />
								<f:setPropertyActionListener value="#{null}" target="#{reportTemplatesDm.template}" />
				</p:commandLink>

				<p:commandLink styleClass="m-mar-left10" action="#{reportTemplatesFm.removeSelectedTemplates()}" update="@form"
							   disabled="#{readonly or reportTemplatesFm.selectedTemplates == null or empty reportTemplatesFm.selectedTemplates}"
							   title="#{overallBundle['box.overall.delete']}">
								<i class="fa fa-trash icon-btn"/>
								<p:confirm header="#{documentTypeTemplateBundle['box.doc.type.template.delete_dialog']}"
                                           message="#{documentTypeTemplateBundle['box.doc.type.template.delete_dialog.details']}" />
				</p:commandLink>
			</p:outputPanel>
		</div>

		<p:dataTable id="doctype_templates_table" value="#{reportTemplatesFm.templates}" var="template"
					 rowKey="#{template.id}" selection="#{reportTemplatesFm.selectedTemplates}"
					 styleClass="paginator-top-hidden"
					 rows="1" paginator="true" rowsPerPageTemplate="1,2,3,5,8"
					 paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown} {CurrentPageReport}"
					 currentPageReportTemplate="{startRecord} - {endRecord} #{overallBundle['box.overall.from']} {totalRecords}"
					 emptyMessage="#{documentTypeTemplateBundle['box.doc.type.template.empty']}">

			<p:ajax event="rowSelectCheckbox" update="@form-property_managed_buttons" />
			<p:ajax event="rowUnselectCheckbox" update="@form-property_managed_buttons" />
			<p:ajax event="rowSelect" update="@form-property_managed_buttons" />
			<p:ajax event="rowUnselect" update="@form-property_managed_buttons" />
			<p:ajax event="toggleSelect" update="@form-property_managed_buttons" />

			<p:column selectionMode="multiple" styleClass="width-16 m-tex-al-center" />

			<p:column headerText="#{overallBundle['box.overall.name']}">
				<h:outputText value="#{template.fileName}" />
			</p:column>

			<p:column headerText="#{overallBundle['box.overall.desc']}">
				<h:outputText value="#{template.description}" />
			</p:column>

			<p:column headerText="#{documentTypeTemplateBundle['box.doc.type.template.added']}">
				<h:outputText value="#{template.creationDate}">
					<sysinf:convertDateTime pattern="#{dateUtils.DATETIME_DEFAULT_PATTERN}" timeZone="#{TZ.userTimeZone}" />
				</h:outputText>
			</p:column>

			<p:column styleClass="width-20">
				<p:commandLink title="#{overallBundle['box.overall.download']}" ajax="false" styleClass="m-mar-right3">
					<i class="icon-get_app fs20 m-bold-gray" />
					<p:fileDownload value="#{reportTemplatesFm.getStreamedContent(template.getIdentifiable())}" />
				</p:commandLink>
			</p:column>
			<p:column styleClass="width-20">
				<p:commandLink update="doctype_templates_edit_form" oncomplete="PF('doctypeTemplatesDlgVar').show()"
							   styleClass="m-mar-right3" title="#{overallBundle['box.overall.edit']}" disabled="#{readonly}">
					<i class="icon-create fs20 m-bold-gray" />
					<f:setPropertyActionListener value="#{reportTemplatesFm.holderDto}" target="#{reportTemplatesDm.holderDto}" />
					<f:setPropertyActionListener value="#{template}" target="#{reportTemplatesDm.template}" />
				</p:commandLink>
			</p:column>
		</p:dataTable>

	</h:form>
</ui:component>