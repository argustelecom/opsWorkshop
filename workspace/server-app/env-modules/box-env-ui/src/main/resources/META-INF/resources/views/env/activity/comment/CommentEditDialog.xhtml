<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:sysinf="http://argustelecom.ru/system-inf" xmlns:pm="http://primefaces.org/modena"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:boxenv="http://argustelecom.ru/box/env">

	<f:loadBundle var="activityBundle" basename="ActivityBundle"/>
	<h:form id="comment_edit_form">

		<p:dialog id="comment_edit_dlg"
			header="#{commentEditDlg.dialogHeader}" width="800"
			widgetVar="commentEditDlgVar" resizable="false" modal="true" closable="false" styleClass="comment-edit">

			<ui:fragment rendered="#{not commentEditDlg.newComment}">
				<dl class="name-value width-130 fs14">
					<dt>
						<p:outputLabel for="comment_author" value="#{activityBundle['box.activity.comment.author']}: " />
					</dt>
					<dd>
						<boxenv:linkToCard id="comment_author" value="#{commentEditDlg.comment.author}"
							text="#{commentEditDlg.comment.author.objectName}"/>
					</dd>

					<dt>
						<p:outputLabel for="comment_creation_date" value="#{activityBundle['box.activity.comment.created']}: " />
					</dt>
					<dd>
						<h:outputText id="comment_creation_date"
							value="#{dateUtils.format(commentEditDlg.comment.creationDate, dateUtils.DATETIME_DEFAULT_PATTERN, TZ.userTimeZone)}" />
					</dd>
				</dl>
			</ui:fragment>

			<dl class="name-value width-130 fs14">
				<dt>
					<p:outputLabel for="comment_header" value="#{activityBundle['box.activity.comment.header']}: " />
				</dt>
				<dd>
					<p:inputText id="comment_header" value="#{commentEditDlg.commentHeader}" maxlength="255" />
				</dd>

				<dt>
					<p:outputLabel for="comment_content" value="#{overallBundle['box.overall.comment']}: " />
				</dt>
				<dd>
					<p:inputTextarea id="comment_content" rows="10" value="#{commentEditDlg.commentContent}" required="true"
						maxlength="5000" counter="comment_content_display"
									 counterTemplate="#{overallBundle['box.overall.chars_left']}" autoResize="false"
									 label="#{overallBundle['box.overall.comment']}"/>
					<h:outputText id="comment_content_display" styleClass="fs12" />
				</dd>
			</dl>

			<div class="dialog-footer-buttons">
				<boxenv:markdownHelp/>
				<p:commandButton id="cancel_button" value="#{overallBundle['box.overall.cancel']}"
								 styleClass="m-blue-text-button" onclick="PF('commentEditDlgVar').hide()"
								 action="#{commentEditDlg.cancel()}" process="@this" />
				<p:commandButton id="submit_button" value="#{overallBundle['box.overall.save']}"
								 oncomplete="if (args &amp;&amp; !args.validationFailed) {PF('commentEditDlgVar').hide()}"
								 action="#{commentEditDlg.submit()}"
								 update="#{commentEditDlg.newComment ? '@(.comments-panel)' : '@(.comment-container)'}" />
			</div>
		</p:dialog>
	</h:form>
</ui:composition>