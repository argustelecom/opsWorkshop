<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
				xmlns:p="http://primefaces.org/ui" xmlns:fn="http://java.sun.com/jsp/jstl/functions"
				xmlns:pe="http://primefaces.org/ui/extensions" xmlns:f="http://java.sun.com/jsf/core"
>

	<ui:param name="columnSize" value="4"/>
	<ui:param name="minRowSize" value="0"/>
	<ui:param name="maxRowSize" value="4"/>
	<ui:param name="firstRawRowIndex" value="0"/>

	<div class="m-container100 m-responsive100">
		<div class="margin-16px clearfix">
			<dl class="name-value width-150">
				<dt>
					<p:outputLabel for="file_name"
								   value="#{tariffBundle['box.telephony.tariff.import.step.map.file_name']}:"/>
				</dt>
				<dd>
					<p:outputLabel id="file_name" value="#{tariffEntryImportDm.fileName}"/>
				</dd>
			</dl>
			<h:outputText value="#{tariffBundle['box.telephony.tariff.import.step.map.hint']}"/>
		</div>

		<div class="margin-16px clearfix">
			<c:choose>
				<c:when test="#{not empty tariffEntryImportDm.rawRows}">
					<table class="width-100-percents">
						<tbody>
							<c:forEach items="#{tariffEntryImportDm.rawRows}" var="rawRow"
									   begin="#{minRowSize}" end="#{maxRowSize}" varStatus="rowIndex">
								<tr>
									<c:forEach items="#{rawRow}" var="column">
										<td class="width-200">
											<h:outputText value="#{column}"/>
										</td>
									</c:forEach>
								</tr>
							</c:forEach>
							<tr>
								<c:forEach items="#{tariffEntryImportDm.rawRows.get(firstRawRowIndex)}" varStatus="columnStatus">
									<td>
										<p:selectOneMenu id="map_select_one_menu_#{columnStatus.index}" styleClass="width-100-percents"
														 value="#{tariffEntryImportDm.selectedAttributes[columnStatus.index]}">
											<p:ajax listener="#{tariffEntryImportDm.manageAttributeSelection(columnStatus.index)}"
													update="tariff_entry_import_form-map_nav_block"/>
											<f:selectItem value="#{null}"
														  itemLabel="#{tariffBundle['box.telephony.tariff.import.step.map.item.dont_use']}"/>
											<f:selectItems value="#{tariffEntryImportDm.attributes}"/>
										</p:selectOneMenu>
									</td>
								</c:forEach>
							</tr>
						</tbody>
					</table>
				</c:when>
				<c:otherwise>
					<h:outputText value="#{overallBundle['box.overall.empty']}"/>
				</c:otherwise>
			</c:choose>
		</div>
	</div>

	<h:panelGroup id="map_nav_block" layout="block" styleClass="dialog-footer-buttons">
		<p:commandButton value="#{overallBundle['box.overall.back']}" oncomplete="PF('entryImportWizardVar').back()"/>

		<p:commandButton value="#{overallBundle['box.overall.next']}" oncomplete="PF('entryImportWizardVar').next()"
						 disabled="#{empty tariffEntryImportDm.rawRows
						 || tariffEntryImportDm.countDistinctSelectedAttributes() lt columnSize
						 || fn:length(tariffEntryImportDm.rawRows.get(firstRawRowIndex)) lt columnSize}"/>
	</h:panelGroup>

</ui:composition>