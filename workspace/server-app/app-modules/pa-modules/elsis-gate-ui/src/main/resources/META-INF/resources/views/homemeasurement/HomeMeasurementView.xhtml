<ui:composition template="/views/inf/page/View.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:o="http://omnifaces.org/ui" xmlns:sysinf="http://argustelecom.ru/system-inf"
                xmlns:pm="http://primefaces.org/modena" xmlns:boxenv="http://argustelecom.ru/box/env">

    <ui:param name="viewModel" value="#{personalAreaVM}"/>
    <ui:param name="pageTitle" value="Показания счетчиков"/>

    <ui:define name="head">
        <h:outputStylesheet name="box-env/styles/box-env.css"/>
        <h:outputStylesheet name="inf/styles/box-functional-block.css"/>
    </ui:define>

    <ui:define name="pagePath">
        <p:menuitem value="Мой кабинет" url="/views/pa/PersonalAreaView.xhtml" />
        <p:menuitem value="Показания приборов учета" styleClass="disabled" />
    </ui:define>

    <ui:define name="body">
        <ui:fragment rendered="#{not empty personalAreaVM.accounts}">
                <div class="m-container100 m-responsive100">
                    <div class="m-container-indent">
                        <div class="m-card m-shadow-effect custom-content-card simple-fb">
                            <h:form id="home_measurement_form">

                                <div class="ui-dashboard-header ui-dashboard-header-dark m-shadow-effect">
                                    <i class="fa fa-tachometer" />
                                    <h:outputText styleClass="card-header" value="Показания приборов учета"/>
                                </div>

                                <p:accordionPanel>
                                    <c:forEach items="#{homeMeasurementVM.homeMeasurementMap.keySet()}" var="location">
                                        <p:tab title="#{location.fullName}" titleStyleClass="fs18">
                                            <p:dataTable id="home_measurement_table" value="#{homeMeasurementVM.homeMeasurementMap.get(location)}"
                                                         emptyMessage="#{overallBundle['box.overall.empty']}" var="measurment">
                                                <p:column headerText="Название">
                                                    <h:outputText value="#{measurment.registryName}" styleClass="fs14"
                                                                  title=""/>
                                                </p:column>

                                                <p:column headerText="Тип">
                                                    <h:outputText value="#{measurment.registryType}" styleClass="fs14"
                                                                  title=""/>
                                                </p:column>

                                                <p:column headerText="Серийный номер">
                                                    <h:outputText value="#{measurment.registrySerialNumber}" styleClass="fs14"
                                                                  title=""/>
                                                </p:column>

                                                <p:column headerText="Показание">
                                                    <h:outputText value="#{measurment.lastMeasurementValue}" styleClass="fs14"
                                                                  title=""/>
                                                </p:column>

                                                <p:column headerText="Единица измерения">
                                                    <h:outputText value="#{measurment.measurementUnit}" styleClass="fs14"
                                                                  title=""/>
                                                </p:column>

                                                <p:column headerText="Показание снято">
                                                    <h:outputText value="#{measurment.lastMeasurementTime}" styleClass="fs14"
                                                                  title="">
                                                        <sysinf:convertDateTime pattern="#{dateUtils.DATETIME_FULL_PATTERN}"/>
                                                    </h:outputText>
                                                </p:column>

                                                <p:column headerText="История показаний" styleClass="text-center">
                                                    <p:commandLink  styleClass="strike-link" oncomplete="PF('HomeMeasurementHistoryDialogVar').show()"
                                                                    title="История показаний" process="@this" update="home_measurement_form_dlg"> Смотреть
                                                        <f:setPropertyActionListener value="#{measurment}" target="#{homeMeasurementVM.selectedHomeMeasurement}"/>
                                                    </p:commandLink>
                                                </p:column>

                                            </p:dataTable>
                                        </p:tab>

                                    </c:forEach>
                                </p:accordionPanel>

                            </h:form>
                        </div>
                    </div>
                </div>
        </ui:fragment>
    </ui:define>

    <ui:define name="dialogs">
        <ui:include src="HomeMeasurementHistoryDialog.xhtml"/> </ui:define>

</ui:composition>

