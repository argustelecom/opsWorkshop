<ui:composition template="/views/inf/page/View.xhtml" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
                xmlns:o="http://omnifaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core">

    <ui:param name="viewModel" value="#{billCardVm}"/>
    <ui:param name="pageTitle" value="#{billBundle['box.bill']}"/>

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="bill" value="#{billCardViewStateModel.bill}" />
            <f:viewParam name="billHistory" value="#{billCardViewStateModel.billHistoryItem}"/>
        </f:metadata>
    </ui:define>

    <ui:define name="head">
        <f:loadBundle var="billBundle" basename="BillBundle"/>

        <h:outputStylesheet name="box-env/styles/box-env.css"/>
        <h:outputStylesheet name="inf/styles/box-functional-block.css"/>
    </ui:define>

    <ui:define name="pagePath">
        <p:menuitem value="#{overallBundle['box.overall.home']}" url="/views/env/home/HomeView.xhtml"/>
        <p:menuitem value="#{billBundle['box.bill.plural']}" url="/views/env/billing/bill/BillListView.xhtml"/>
        <c:choose>
            <c:when test="#{billCardViewStateModel.bill ne null}">
                <p:menuitem value="#{billBundle['box.bill']} #{billCardViewStateModel.bill.documentNumber}"/>
            </c:when>
            <c:when test="#{billCardViewStateModel.billHistoryItem ne null}">
                <p:menuitem value="#{billBundle['box.bill']} #{billCardViewStateModel.billHistoryItem.bill.documentNumber}
                = #{billBundle['box.bill.history.version']} #{billCardViewStateModel.billHistoryItem.version + 1}"/>
            </c:when>
        </c:choose>
    </ui:define>

    <ui:define name="body">

        <ui:include src="BillAtributesFrame.xhtml"/>

        <ui:include src="BillChargeFrame.xhtml"/>

        <div class="m-container100 m-responsive100">
            <div class="m-container50 m-responsive100">
                <ui:include src="BillSendingInfoFrame.xhtml">
                    <ui:param name="bill" value="#{billCardViewStateModel.bill}"/>
                </ui:include>

                <ui:include src="BillHistoryFrame.xhtml"/>
            </div>
            <div class="m-container50 m-responsive100">
                <ui:include src="BillAdditionInfoFrame.xhtml"/>
            </div>
        </div>

    </ui:define>

    <ui:define name="dialogs">
        <ui:include src="BillRecalculationDialog.xhtml">
            <ui:param name="update" value="invoice_entries_form bill_history_form bill_analytic_form bill_attributes_form"/>
        </ui:include>

        <ui:include src="BillSendDialog.xhtml">
            <ui:param name="runAfterSending" value="#{billSendingInfoFm.runAfterSending()}"/>
        </ui:include>
    </ui:define>

</ui:composition>