<ui:composition template="/views/inf/page/View.xhtml" xmlns="http://www.w3.org/1999/xhtml"
				xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
				xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
				xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
				xmlns:o="http://omnifaces.org/ui" xmlns:sysinf="http://argustelecom.ru/system-inf"
				xmlns:pm="http://primefaces.org/modena">

	<ui:param name="viewModel" value="#{invoiceCardVm}"/>
	<ui:param name="pageTitle" value="#{invoiceBundle['box.invoice']}"/>

	<ui:define name="metadata">
		<f:metadata>
			<f:viewParam name="invoice" value="#{currentInvoice.value}" required="#{!facesContext.postback}"
						 requiredMessage="Invoice param required"/>
		</f:metadata>
	</ui:define>

	<ui:define name="head">
		<h:outputStylesheet name="box-env/styles/box-env.css"/>
		<h:outputStylesheet name="inf/styles/box-functional-block.css"/>
		<f:loadBundle var="invoiceBundle" basename="InvoiceBundle"/>
	</ui:define>

	<ui:define name="pagePath">
		<p:menuitem value="#{overallBundle['box.overall.home']}" url="/views/env/home/HomeView.xhtml"/>
		<p:menuitem value="#{invoiceBundle['box.invoice.customer.plural']}" url="/views/env/customer/CustomerListView.xhtml" />
		<o:importConstants type="ru.argustelecom.box.env.page.navigation.CardType" var="cardType"/>
		<p:menuitem value="#{invoiceCardVm.invoice.personalAccount.customer.objectName}" disabled="#{!p:ifGranted(cardType.CUSTOMER.permissionId)}"
					url="#{cardNavigator.getOutcome(currentInvoice.value.personalAccount.customer)}"/>
		<p:menuitem value="#{invoiceCardVm.invoice.personalAccount.objectName}" disabled="#{!p:ifGranted(cardType.PERSONAL_ACCOUNT.permissionId)}"
					url="#{cardNavigator.getOutcome(currentInvoice.value.personalAccount)}"/>
		<p:menuitem value="#{invoiceBundle['box.invoice']} #{invoiceCardVm.invoice.id}"/>
	</ui:define>

	<ui:define name="body">
		<o:importConstants type="ru.argustelecom.box.env.billing.invoice.InvoiceCardViewModel.InvoiceCardType"/>

		<pe:switch value="#{invoiceCardVm.cardType}">
			<pe:case value="#{InvoiceCardType.SHORT_TERM}">
				<ui:include src="ShortTermInvoiceAttributesFrame.xhtml">
					<ui:param name="invoice" value="#{invoiceCardVm.invoice}"/>
				</ui:include>

				<div class="m-container100 m-responsive100">
					<ui:include src="InvoiceEntriesFrame.xhtml">
						<ui:param name="invoice" value="#{invoiceCardVm.invoice}"/>
					</ui:include>
				</div>
			</pe:case>

			<pe:case value="#{InvoiceCardType.LONG_TERM}">
				<ui:include src="LongTermInvoiceAttributesFrame.xhtml">
					<ui:param name="invoice" value="#{invoiceCardVm.invoice}"/>
				</ui:include>

				<div class="m-container100 m-responsive100">
					<div class="m-container40 m-responsive100">
						<ui:include src="InvoiceDetailFrame.xhtml">
							<ui:param name="invoicePlan" value="#{invoiceCardVm.invoice.plan}"/>
						</ui:include>
					</div>
					<div class="m-container60 m-responsive100">
						<ui:include src="/views/env/billing/invoice/InvoicePrivilegeFrame.xhtml">
							<ui:param name="privileges" value="#{invoiceCardVm.privileges}"/>
						</ui:include>
					</div>
				</div>
			</pe:case>

			<pe:case value="#{InvoiceCardType.USAGE}">
				<ui:include src="UsageInvoiceAttributesFrame.xhtml">
					<ui:param name="invoice" value="#{invoiceCardVm.invoice}"/>
				</ui:include>

				<div class="m-container100 m-responsive100">
					<ui:include src="UsageInvoiceDetailFrame.xhtml">
						<ui:param name="entriesDto" value="#{invoiceCardVm.usageInvoiceEntriesDto}"/>
					</ui:include>
				</div>
			</pe:case>
		</pe:switch>

	</ui:define>

	<ui:define name="dialogs">
		<ui:include src="/views/env/activity/comment/CommentEditDialog.xhtml"/>
	</ui:define>

</ui:composition>