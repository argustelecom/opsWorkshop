<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:sysinf="http://argustelecom.ru/system-inf" xmlns:pm="http://primefaces.org/modena"
	xmlns:f="http://java.sun.com/jsf/core">

	<ui:fragment rendered="#{lifecycleFm.isRendered(businessObject)}">

		<ui:fragment rendered="#{routeActionModel eq null}">
			<ui:fragment rendered="#{not empty lifecycleFm.getSecondaryRoutes(businessObject)}">
				<p:splitButton id="main_route_among_others" value="#{lifecycleFm.getMainRoute(businessObject).name}"
							   action="#{lifecycleFm.performRoute(businessObject, phaseListener)}"
							   update="#{update}" styleClass="#{styleClass}" disabled="#{readonly}">

					<c:forEach var="route" items="#{lifecycleFm.getSecondaryRoutes(businessObject)}">
						<p:menuitem value="#{route.name}"
									action="#{lifecycleFm.performRoute(businessObject, route, phaseListener)}"
									update="#{update}" disabled="#{readonly}" />
					</c:forEach>
				</p:splitButton>
			</ui:fragment>

			<ui:fragment rendered="#{empty lifecycleFm.getSecondaryRoutes(businessObject)}">
				<p:commandButton id="main_route" value="#{lifecycleFm.getMainRoute(businessObject).name}"
								 action="#{lifecycleFm.performRoute(businessObject, phaseListener)}"
								 update="#{update}" styleClass="#{styleClass}" disabled="#{readonly}"/>
			</ui:fragment>
		</ui:fragment>

		<ui:fragment rendered="#{routeActionModel ne null}">
			<ui:repeat value="#{lifecycleFm.getRoutes(businessObject)}" var="route">
				<p:commandLink title="#{route.name}"
							   action="#{lifecycleFm.performRoute(businessObject, route, phaseListener)}"
							   disabled="#{readonly}" update="#{update}">
					<i class="m-mar-left-8 fs20 m-bold-gray #{routeActionModel.getStyleClass(route.keyword)}"/>
				</p:commandLink>
			</ui:repeat>
		</ui:fragment>

	</ui:fragment>
</ui:composition>