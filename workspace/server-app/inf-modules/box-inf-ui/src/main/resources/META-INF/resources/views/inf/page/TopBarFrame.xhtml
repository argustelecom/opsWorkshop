<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core" xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions" xmlns:o="http://omnifaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough" xmlns:pm="http://primefaces.org/modena"
	xmlns:of="http://omnifaces.org/functions">

	<!-- f:view locale="#{languageBean.locale}" -->
	<f:loadBundle var="topBarBundle" basename="TopBarBundle"/>

	<!-- Наличие компонента с id layout_topbar обязательно по требованию структуры modena-layout -->
	<div id="layout_topbar">

		<!-- Наличие компонента с id mobile_menu_button обязательно по требованию структуры modena-layout -->
		<a id="mobile_menu_button">
			<span class="m-button-line" id="button_line1" />
			<span class="m-button-line"	id="button_line2" />
			<span class="m-button-line" id="button_line3" />
		</a>

		<p:link id="logo" href="/views/env/home/HomeView.xhtml" rendered="#{p:ifGranted('User')}">
			<p:graphicImage name="box-inf/images/logo-light.png" styleClass="m-fleft" />
		</p:link>

		<!-- Наличие компонента с id show_top_menu обязательно по требованию структуры modena-layout -->
		<a id="show_top_menu" class="m-show-on-mobile ripplelink"> 
			<i class="icon-more_vert" id="active" /> 
			<i class="icon-close m-disp-none" id="passive" />
		</a>

		<h:form id="top_menu_form">
			<!-- Наличие компонента с id top_menu обязательно по требованию структуры modena-layout -->
			<ul id="top_menu">
		
				<!-- Заготовка для поиска в mobile окружении -->
				<!--<li class="m-show-on-mobile">-->
					<!--<a class="ripplelink"><i class="icon-search" /><span>#{overallBundle['box.overall.search_everywhere']}</span></a>-->
					<!--<ul>-->
						<!--<li class="ui-search-ew-mobile">-->
							<!--<ui:include src="SearchEverywereFrame.xhtml" />-->
						<!--</li>-->
					<!--</ul>-->
				<!--</li>-->
		
				<!-- За наполнение всего остального контента отвечает среда -->
				<ui:fragment rendered="#{p:ifGranted('User')}">
					<ui:insert name="topMenuContent">
						<ui:include src="/views/env/page/TopBarContentFrame.xhtml" />
					</ui:insert>
				</ui:fragment>

				<!-- Cмена локали -->
				<!-- BOX-2482 -->
				<!-- <h:panelGroup layout="block" rendered="true">
					<li>
						<a class="ripplelink" title="#{topBarBundle['box.top_bar.language']}" >
							<p:graphicImage name="inf/images/nls/flag_#{languageBean.localeIcons[languageBean.locale]}.png" />
						</a>
						<ul>
							<ui:repeat value="#{of:setToList(languageBean.localeIcons.entrySet())}" var="entry">
								<li>
									<p:commandLink styleClass="ripplelink">
										<p:graphicImage name="inf/images/nls/flag_#{entry.value}.png" styleClass="m-fleft" />
										<h:outputText value="#{languageBean.getDisplayName(entry.key)}" style="margin-left: 5px;" />
										<p:ajax process="@this" update="@all" listener="#{languageBean.setLocale(entry.key)}"/>
									</p:commandLink>
								</li>
							</ui:repeat>
						</ul>
					</li>
				</h:panelGroup> -->
				
				<!-- Выход из системы -->
				<li>
					<p:commandLink id="logout" styleClass="ripplelink" title="#{topBarBundle['box.top_bar.log_out']}"
						action="#{logoutBean.logout()}" immediate="true" process="@this" async="true">
						<i class="icon-power" /> <span class="m-show-on-mobile">#{topBarBundle['box.top_bar.log_out']}</span>
					</p:commandLink>
				</li>
			</ul>
		
			<!-- Заготовка для поиска в desktop окружении -->
			<div class="ui-search-ew-desktop m-show-on-desktop">
				<ui:include src="SearchEverywereFrame.xhtml" />
			</div>
		</h:form>
	</div>
	
	<!-- /f:view -->

</ui:composition>